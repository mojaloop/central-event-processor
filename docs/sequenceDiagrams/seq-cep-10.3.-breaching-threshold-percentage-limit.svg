<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1080.6px" preserveAspectRatio="none" style="width:551px;height:1080px;" version="1.1" viewBox="0 0 551 1080" width="551.4px" zoomAndPan="magnify"><defs><filter height="300%" id="f1mkech80whkxd" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="1.2000000476837158"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="2.4000000953674316" dy="2.4000000953674316" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187.2" x="182.85" y="14.1211">10.3. Breaching Threshold Percentage Limit</text><rect fill="#FFFFE0" height="1053.4348" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="165.6" x="17.4" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="67.8" y="28.234">Central Services</text><rect fill="#90EE90" height="1053.4348" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="293.4" x="236.1" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="136.2" x="314.7" y="28.234">Central Event Processing Services</text><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="50.1" y="264.1149"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="50.1" y="364.4602"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="133.5" y="146.5969"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="945.8766" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="285.9" y="77.2652"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="502.5" y="299.7012"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="79.5316" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="502.5" y="400.0465"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="502.5" y="564.5098"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="70.3453" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="502.5" y="789.1325"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="502.5" y="962.9825"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="941.6766" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="537.3" x="7.8" y="81.4652"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="787.186" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="525.3" x="13.8" y="231.7559"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="336.1137" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="306.6" x="226.5" y="669.6551"/><rect fill="#FFFFFF" height="263.782" style="stroke: none; stroke-width: 0.6000000238418579;" width="306.6" x="226.5" y="741.9867"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="44.7457" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="236.4" x="232.5" y="901.2504"/><rect fill="#FFFFFF" height="8.973" style="stroke: none; stroke-width: 0.6000000238418579;" width="236.4" x="232.5" y="937.0231"/><rect fill="#FFFFFF" height="8.973" style="stroke: none; stroke-width: 0.6000000238418579;" width="525.3" x="13.8" y="1009.9688"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="52.8" x2="52.8" y1="71.2652" y2="1033.3418"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="136.2" x2="136.2" y1="71.2652" y2="1033.3418"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="288.9" x2="288.9" y1="71.2652" y2="1033.3418"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="505.5" x2="505.5" y1="71.2652" y2="1033.3418"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="63" x="19.8" y="59.6004">Central-Ledger</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="42.6" x="30" y="69.4934">Admin API</text><path d="M40.8,34.6793 L40.8,49.0793 M40.8,41.8793 L51,41.8793 " fill="none" filter="url(#f1mkech80whkxd)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><ellipse cx="58.2" cy="41.8793" fill="#FEFECE" filter="url(#f1mkech80whkxd)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="63" x="19.8" y="1040.8629">Central-Ledger</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="42.6" x="30" y="1050.7559">Admin API</text><path d="M40.8,1054.9278 L40.8,1069.3278 M40.8,1062.1278 L51,1062.1278 " fill="none" filter="url(#f1mkech80whkxd)" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><ellipse cx="58.2" cy="1062.1278" fill="#FEFECE" filter="url(#f1mkech80whkxd)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><rect fill="#FEFECE" filter="url(#f1mkech80whkxd)" height="18.293" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="83.4" x="94.8" y="47.5723"/><rect fill="#FEFECE" filter="url(#f1mkech80whkxd)" height="18.293" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="83.4" x="92.4" y="49.9723"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="75" x="96.6" y="62.2934">Notification-Topic</text><rect fill="#FEFECE" filter="url(#f1mkech80whkxd)" height="18.293" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="83.4" x="94.8" y="1032.7418"/><rect fill="#FEFECE" filter="url(#f1mkech80whkxd)" height="18.293" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="83.4" x="92.4" y="1035.1418"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="75" x="96.6" y="1047.4629">Notification-Topic</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="97.2" x="238.5" y="69.4934">Central Event Processor</text><ellipse cx="288.9" cy="51.7723" fill="#FEFECE" filter="url(#f1mkech80whkxd)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><polygon fill="#A80036" points="286.5,44.5723,290.1,41.5723,288.9,44.5723,290.1,47.5723,286.5,44.5723" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="97.2" x="238.5" y="1040.8629">Central Event Processor</text><ellipse cx="288.9" cy="1052.2348" fill="#FEFECE" filter="url(#f1mkech80whkxd)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><polygon fill="#A80036" points="286.5,1045.0348,290.1,1042.0348,288.9,1045.0348,290.1,1048.0348,286.5,1045.0348" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="39.6" x="483.9" y="69.4934">CEP Store</text><path d="M494.7,39.7723 C494.7,33.7723 505.5,33.7723 505.5,33.7723 C505.5,33.7723 516.3,33.7723 516.3,39.7723 L516.3,55.3723 C516.3,61.3723 505.5,61.3723 505.5,61.3723 C505.5,61.3723 494.7,61.3723 494.7,55.3723 L494.7,39.7723 " fill="#FEFECE" filter="url(#f1mkech80whkxd)" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><path d="M494.7,39.7723 C494.7,45.7723 505.5,45.7723 505.5,45.7723 C505.5,45.7723 516.3,45.7723 516.3,39.7723 " fill="none" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="39.6" x="483.9" y="1040.8629">CEP Store</text><path d="M494.7,1048.6348 C494.7,1042.6348 505.5,1042.6348 505.5,1042.6348 C505.5,1042.6348 516.3,1042.6348 516.3,1048.6348 L516.3,1064.2348 C516.3,1070.2348 505.5,1070.2348 505.5,1070.2348 C505.5,1070.2348 494.7,1070.2348 494.7,1064.2348 L494.7,1048.6348 " fill="#FEFECE" filter="url(#f1mkech80whkxd)" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><path d="M494.7,1048.6348 C494.7,1054.6348 505.5,1054.6348 505.5,1054.6348 C505.5,1054.6348 516.3,1054.6348 516.3,1048.6348 " fill="none" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="50.1" y="264.1149"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="50.1" y="364.4602"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="133.5" y="146.5969"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="945.8766" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="285.9" y="77.2652"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="502.5" y="299.7012"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="79.5316" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="502.5" y="400.0465"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="502.5" y="564.5098"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="70.3453" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="502.5" y="789.1325"/><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="502.5" y="962.9825"/><path d="M7.8,81.4652 L119.4,81.4652 L119.4,85.6652 L113.4,91.6652 L7.8,91.6652 L7.8,81.4652 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="941.6766" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="537.3" x="7.8" y="81.4652"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="84.6" x="16.8" y="89.6063">Limit Position Breach</text><path d="M39.6,94.8516 L39.6,127.8516 L130.8,127.8516 L130.8,100.8516 L124.8,94.8516 L39.6,94.8516 " fill="#D3D3D3" filter="url(#f1mkech80whkxd)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M124.8,94.8516 L124.8,100.8516 L130.8,100.8516 L124.8,94.8516 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="78" x="43.2" y="105.3926">Events are published</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="78.6" x="43.2" y="114.5789">to Notification Topic</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="73.8" x="43.2" y="123.7652">by Central Services.</text><polygon fill="#A80036" points="146.1,144.1969,140.1,146.5969,146.1,148.9969,143.7,146.5969" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="142.5" x2="285.3" y1="146.5969" y2="146.5969"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="149.7" y="143.7516">1</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="125.4" x="157.5" y="143.7516">Consumes notification messages</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="291.9" x2="317.1" y1="182.1832" y2="182.1832"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="317.1" x2="317.1" y1="182.1832" y2="189.9832"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="292.5" x2="317.1" y1="189.9832" y2="189.9832"/><polygon fill="#A80036" points="298.5,187.5832,292.5,189.9832,298.5,192.3832,296.1,189.9832" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="296.1" y="179.3379">2</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="117.6" x="303.9" y="179.3379">Filter according to event action</text><path d="M294.6,197.7832 L294.6,221.7832 L491.4,221.7832 L491.4,203.7832 L485.4,197.7832 L294.6,197.7832 " fill="#FFFF00" filter="url(#f1mkech80whkxd)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M485.4,197.7832 L485.4,203.7832 L491.4,203.7832 L485.4,197.7832 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="90" x="298.2" y="208.3242">Qualifying event action:</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="184.2" x="298.2" y="217.5106">{data.value.metadata.event.action === 'commit'}</text><path d="M13.8,231.7559 L51,231.7559 L51,235.9559 L45,241.9559 L13.8,241.9559 L13.8,231.7559 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="787.186" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="525.3" x="13.8" y="231.7559"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.2" x="22.8" y="239.8969">alt</text><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="114" x="60" y="239.3367">[Messages event type that qualify]</text><polygon fill="#A80036" points="62.7,261.7149,56.7,264.1149,62.7,266.5149,60.3,264.1149" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="59.1" x2="285.3" y1="264.1149" y2="264.1149"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="66.3" y="256.6764">3</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="189.6" x="74.1" y="252.0832">Request notification info for both payee and payer</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="48" x="74.1" y="261.2695">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="43.2" x="124.5" y="261.2695">2001, 2003</text><polygon fill="#A80036" points="495.3,297.3012,501.3,299.7012,495.3,302.1012,497.7,299.7012" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="291.9" x2="498.9" y1="299.7012" y2="299.7012"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="296.1" y="296.8559">4</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="155.4" x="303.9" y="296.8559">Persist message related data to CEP store</text><polygon fill="#FFFFE0" filter="url(#f1mkech80whkxd)" points="492,325.5012,519,325.5012,525,332.1012,519,339.3012,492,339.3012,486,332.1012,492,325.5012" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="24.6" x="493.2" y="335.4422">events</text><polygon fill="#A80036" points="62.7,362.0602,56.7,364.4602,62.7,366.8602,60.3,364.4602" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="59.1" x2="285.3" y1="364.4602" y2="364.4602"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="66.3" y="357.0217">5</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="210.6" x="74.1" y="352.4285">Request current positions info for both payee and payer</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="48" x="74.1" y="361.6149">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="43.2" x="124.5" y="361.6149">2001, 2003</text><polygon fill="#A80036" points="495.3,397.6465,501.3,400.0465,495.3,402.4465,497.7,400.0465" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="291.9" x2="498.9" y1="400.0465" y2="400.0465"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="296.1" y="397.2012">6</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="83.4" x="303.9" y="397.2012">Request current limits</text><polygon fill="#FFFFE0" filter="url(#f1mkech80whkxd)" points="493.2,407.8465,517.2,407.8465,523.2,414.4465,517.2,421.6465,493.2,421.6465,487.2,414.4465,493.2,407.8465" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="21.6" x="494.4" y="417.7875">limits</text><path d="M294.6,427.8328 L294.6,460.8328 L401.4,460.8328 L401.4,433.8328 L395.4,427.8328 L294.6,427.8328 " fill="#D3D3D3" filter="url(#f1mkech80whkxd)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M395.4,427.8328 L395.4,433.8328 L401.4,433.8328 L395.4,427.8328 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="75.6" x="298.2" y="438.3738">API call to CEP Store</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="69.6" x="298.2" y="447.5602">requesting current</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22.2" x="370.2" y="447.5602">limits</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="298.2" y="456.7465">for</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24.6" x="311.4" y="456.7465">payee</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="13.8" x="338.4" y="456.7465">and</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23.4" x="354.6" y="456.7465">payer</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="378" y="456.7465">.</text><polygon fill="#A80036" points="298.5,477.1781,292.5,479.5781,298.5,481.9781,296.1,479.5781" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="294.9" x2="504.9" y1="479.5781" y2="479.5781"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="302.1" y="476.7328">7</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="106.2" x="309.9" y="476.7328">Return results current limits</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="291.9" x2="317.1" y1="497.1645" y2="497.1645"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="317.1" x2="317.1" y1="497.1645" y2="504.9645"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="292.5" x2="317.1" y1="504.9645" y2="504.9645"/><polygon fill="#A80036" points="298.5,502.5645,292.5,504.9645,298.5,507.3645,296.1,504.9645" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="296.1" y="494.3192">8</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="0" x="306.3" y="494.3192"/><path d="M294.6,512.7645 L294.6,545.7645 L455.4,545.7645 L455.4,518.7645 L449.4,512.7645 L294.6,512.7645 " fill="#D3D3D3" filter="url(#f1mkech80whkxd)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M449.4,512.7645 L449.4,518.7645 L455.4,518.7645 L449.4,512.7645 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="78.6" x="298.2" y="523.3055">Calculate the current</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="379.2" y="523.3055">threshold</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46.2" x="298.2" y="532.4918">percentage</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="30.6" x="346.8" y="532.4918">for both</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24.6" x="379.8" y="532.4918">payee</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="13.8" x="406.8" y="532.4918">and</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23.4" x="423" y="532.4918">payer</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="22.2" x="298.2" y="541.6781">for all</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42.6" x="322.8" y="541.6781">currencies</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="365.4" y="541.6781">.</text><polygon fill="#A80036" points="495.3,562.1098,501.3,564.5098,495.3,566.9098,497.7,564.5098" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="291.9" x2="498.9" y1="564.5098" y2="564.5098"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="296.1" y="561.6645">9</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="180" x="303.9" y="561.6645">Persist new position with threshold information</text><polygon fill="#FFFFE0" filter="url(#f1mkech80whkxd)" points="493.2,590.3098,517.2,590.3098,523.2,596.9098,517.2,604.1098,493.2,604.1098,487.2,596.9098,493.2,590.3098" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="21.6" x="494.4" y="600.2508">limits</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="291.9" x2="317.1" y1="620.0824" y2="620.0824"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="317.1" x2="317.1" y1="620.0824" y2="627.8824"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="292.5" x2="317.1" y1="627.8824" y2="627.8824"/><polygon fill="#A80036" points="298.5,625.4824,292.5,627.8824,298.5,630.2824,296.1,627.8824" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="296.1" y="617.2371">10</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="0" x="311.7" y="617.2371"/><path d="M294.6,635.6824 L294.6,659.6824 L381,659.6824 L381,641.6824 L375,635.6824 L294.6,635.6824 " fill="#D3D3D3" filter="url(#f1mkech80whkxd)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M375,635.6824 L375,641.6824 L381,641.6824 L375,635.6824 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="55.8" x="298.2" y="646.2235">Evaluate 'facts'</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="73.8" x="298.2" y="655.4098">Invoke Rule Engine.</text><path d="M226.5,669.6551 L263.7,669.6551 L263.7,673.8551 L257.7,679.8551 L226.5,679.8551 L226.5,669.6551 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="336.1137" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="306.6" x="226.5" y="669.6551"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.2" x="235.5" y="677.7961">alt</text><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="79.8" x="272.7" y="677.236">[Threshold is breached]</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="291.9" x2="317.1" y1="692.8278" y2="692.8278"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="317.1" x2="317.1" y1="692.8278" y2="700.6278"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="292.5" x2="317.1" y1="700.6278" y2="700.6278"/><polygon fill="#A80036" points="298.5,698.2278,292.5,700.6278,298.5,703.0278,296.1,700.6278" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="296.1" y="689.9824">11</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="41.4" x="309.3" y="689.9824">Create new</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54.6" x="353.1" y="689.9824">Action Object</text><rect fill="#FFFFFF" filter="url(#f1mkech80whkxd)" height="33.559" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="123" x="236.7" y="705.4278"/><polygon fill="#EEEEEE" points="236.7,705.4278,275.1,705.4278,275.1,709.6278,269.1,715.6278,236.7,715.6278,236.7,705.4278" style="stroke: #000000; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="11.4" x="244.5" y="714.1688">ref</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="96.6" x="240.3" y="725.5688">Notification Action Flow {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/central-event-processor/tree/master/docs/sequenceDiagrams/seq-cep-10.4-action-flow.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/central-event-processor/tree/master/docs/sequenceDiagrams/seq-cep-10.4-action-flow.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="16.8" x="336.9" y="725.5688">10.4</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="336.9" x2="353.7" y1="726.7688" y2="726.7688"/></a><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="353.7" y="725.5688">}</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="0" x="242.7" y="734.7551"/><line style="stroke: #000000; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="226.5" x2="533.1" y1="742.5867" y2="742.5867"/><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131.4" x="229.5" y="748.9676">[Threshold not breached - same event]</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="291.9" x2="317.1" y1="763.7461" y2="763.7461"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="317.1" x2="317.1" y1="763.7461" y2="771.5461"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="292.5" x2="317.1" y1="771.5461" y2="771.5461"/><polygon fill="#A80036" points="298.5,769.1461,292.5,771.5461,298.5,773.9461,296.1,771.5461" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="296.1" y="760.9008">12</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="42" x="309.3" y="760.9008">Send finish</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54.6" x="353.7" y="760.9008">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="59.4" x="410.7" y="760.9008">to Action Agent</text><polygon fill="#A80036" points="495.3,786.7325,501.3,789.1325,495.3,791.5325,497.7,789.1325" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="291.9" x2="498.9" y1="789.1325" y2="789.1325"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="296.1" y="786.2871">13</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="30" x="309.3" y="786.2871">Request</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54.6" x="341.7" y="786.2871">Action Object</text><path d="M294.6,796.9325 L294.6,820.9325 L429,820.9325 L429,802.9325 L423,796.9325 L294.6,796.9325 " fill="#D3D3D3" filter="url(#f1mkech80whkxd)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M423,796.9325 L423,802.9325 L429,802.9325 L423,796.9325 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="298.2" y="807.4735">Request previous</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54.6" x="365.4" y="807.4735">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="91.2" x="298.2" y="816.6598">with same event details.</text><polygon fill="#FFFFE0" filter="url(#f1mkech80whkxd)" points="492.6,829.7051,518.4,829.7051,524.4,836.3051,518.4,843.5051,492.6,843.5051,486.6,836.3051,492.6,829.7051" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="23.4" x="493.8" y="839.6461">action</text><polygon fill="#A80036" points="298.5,857.0778,292.5,859.4778,298.5,861.8778,296.1,859.4778" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="294.9" x2="504.9" y1="859.4778" y2="859.4778"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="302.1" y="856.6325">14</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="52.8" x="315.3" y="856.6325">Return results</text><path d="M294.6,867.2778 L294.6,891.2778 L506.4,891.2778 L506.4,873.2778 L500.4,867.2778 L294.6,867.2778 " fill="#FFFF00" filter="url(#f1mkech80whkxd)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M500.4,867.2778 L500.4,873.2778 L506.4,873.2778 L500.4,867.2778 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="61.2" x="298.2" y="877.8188">Event details for</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54.6" x="361.8" y="877.8188">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="416.4" y="877.8188">:</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="199.2" x="298.2" y="887.0051">{limitType, currency, dfsp, notificationEndpointType}</text><path d="M232.5,901.2504 L269.7,901.2504 L269.7,905.4504 L263.7,911.4504 L232.5,911.4504 L232.5,901.2504 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="44.7457" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="236.4" x="232.5" y="901.2504"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.2" x="241.5" y="909.3914">alt</text><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="278.7" y="908.8313">[Action event exist]</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="291.9" x2="317.1" y1="924.4231" y2="924.4231"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="317.1" x2="317.1" y1="924.4231" y2="932.2231"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="292.5" x2="317.1" y1="932.2231" y2="932.2231"/><polygon fill="#A80036" points="298.5,929.8231,292.5,932.2231,298.5,934.6231,296.1,932.2231" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="296.1" y="921.5778">15</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="72.6" x="309.3" y="921.5778">Deactivate pending</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54.6" x="384.3" y="921.5778">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="20.4" x="441.3" y="921.5778">event</text><line style="stroke: #000000; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="232.5" x2="468.9" y1="937.6231" y2="937.6231"/><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="235.5" y="944.0039">[Action event does not exist]</text><polygon fill="#A80036" points="495.3,960.5825,501.3,962.9825,495.3,965.3825,497.7,962.9825" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="291.9" x2="498.9" y1="962.9825" y2="962.9825"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="296.1" y="960.1371">16</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="58.2" x="309.3" y="960.1371">Persist updated</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54.6" x="369.9" y="960.1371">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="68.4" x="426.9" y="960.1371">event to CEP Store</text><polygon fill="#FFFFE0" filter="url(#f1mkech80whkxd)" points="492.6,988.7825,518.4,988.7825,524.4,995.3825,518.4,1002.5825,492.6,1002.5825,486.6,995.3825,492.6,988.7825" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="23.4" x="493.8" y="998.7235">action</text><line style="stroke: #000000; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="13.8" x2="539.1" y1="1010.5688" y2="1010.5688"/><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="166.8" x="16.8" y="1016.9496">[Message does not qualify for notification action]</text><!--
@startuml
title 10.3. Breaching Threshold Percentage Limit
autonumber

collections "Notification-Topic" as topicNotify
boundary "Central-Ledger\nAdmin API" as CLAPI
control "Central Event Processor" as CEP
database "CEP Store" as DB

box "Central Services" #LightYellow
participant CLAPI
participant topicNotify
end box
box "Central Event Processing Services" #LightGreen
participant CEP
participant DB
end box

Group Limit Position Breach
    activate CEP
    note left of topicNotify #LightGrey
        Events are published
        to Notification Topic
        by Central Services.
    end note
    topicNotify <- CEP: Consumes notification messages
    activate topicNotify
    deactivate topicNotify
    CEP -> CEP: Filter according to event action
    note right of CEP #yellow
        Qualifying event action:
        {data.value.metadata.event.action === 'commit'}
    end note

    alt Messages event type that qualify
        CLAPI <- CEP: Request notification info for both payee and payer\n<color #FF0000><b>Error codes:</b> 2001, 2003 </color>
        activate CLAPI
        deactivate CLAPI
        CEP -> DB: Persist message related data to CEP store
        activate DB
        hnote over DB #LightYellow
            events
        end hnote
        deactivate DB
        CLAPI <- CEP: Request current positions info for both payee and payer\n<color #FF0000><b>Error codes:</b> 2001, 2003 </color>
        activate CLAPI
        deactivate CLAPI
        CEP -> DB: Request current limits
        activate DB
        hnote over DB #LightYellow
            limits
        end hnote
        note right of CEP #LightGrey
            API call to CEP Store
            requesting current **limits**
            for **payee** and **payer**.
        end note
        CEP <- - DB: Return results current limits
        deactivate DB
        CEP -> CEP:
        note right of CEP #LightGrey
            Calculate the current **threshold**
            **percentage** for both **payee** and **payer**
            for all **currencies**.
        end note
        CEP -> DB: Persist new position with threshold information
        activate DB
        hnote over DB #LightYellow
            limits
        end hnote
        deactivate DB
        CEP -> CEP
        note right of CEP #LightGrey
            Evaluate 'facts'
            Invoke Rule Engine.
        end note

        alt Threshold is breached
            CEP -> CEP: Create new **Action Object**
            ref over CEP :  Notification Action Flow {[[https://github.com/mojaloop/central-event-processor/tree/master/docs/sequenceDiagrams/seq-cep-10.4-action-flow.svg 10.4]]} \n
        else Threshold not breached - same event
            CEP -> CEP: Send finish **Action Object** to Action Agent
            CEP -> DB: Request **Action Object**
            note right of CEP #LightGrey
                Request previous **Action Object**
                with same event details.
            end note
            activate DB
        hnote over DB #LightYellow
            action
        end hnote
        CEP <- - DB: Return results
        deactivate DB
            note right of CEP #yellow
                Event details for **Action Object**:
                {limitType, currency, dfsp, notificationEndpointType}
            end note
            alt Action event exist
                CEP -> CEP: Deactivate pending **Action Object** event
            else Action event does not exist
            end
        CEP -> DB: Persist updated **Action Object** event to CEP Store
        activate DB
        hnote over DB #LightYellow
            action
        end hnote
        deactivate DB
        end
    else Message does not qualify for notification action
    end
    deactivate CEP
end
@enduml

PlantUML version 1.2018.11(Sat Sep 22 18:43:53 SAST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1343-b26
Operating System: Mac OS X
OS Version: 10.14.2
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>