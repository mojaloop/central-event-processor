<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="783px" preserveAspectRatio="none" style="width:462px;height:783px;" version="1.1" viewBox="0 0 462 783" width="462.6px" zoomAndPan="magnify"><defs><filter height="300%" id="fuqztke2objy4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="1.2000000476837158"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="2.4000000953674316" dy="2.4000000953674316" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="228" x="118.05" y="14.1211">10.2. Notification Limit Adjustment Rules Validation</text><rect fill="#FFFFE0" height="756.2672" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="93" x="63.6" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="64.8" x="77.7" y="28.234">Central Services</text><rect fill="#90EE90" height="756.2672" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="232.8" x="207.9" y="20.693"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="132" x="258.3" y="28.234">Central Event Processing Service</text><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="107.1" y="145.1039"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="655.8949" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="257.7" y="75.7723"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="413.7" y="253.4356"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="413.7" y="309.0082"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="37.5727" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="413.7" y="588.5625"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="413.7" y="667.3078"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="647.4949" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="449.1" x="7.2" y="79.9723"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="493.0043" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="252" x="198.3" y="230.2629"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="277.568" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="240" x="204.3" y="432.5262"/><rect fill="#FFFFFF" height="205.2363" style="stroke: none; stroke-width: 0.6000000238418579;" width="240" x="204.3" y="504.8578"/><rect fill="#FFFFFF" height="8.973" style="stroke: none; stroke-width: 0.6000000238418579;" width="252" x="198.3" y="714.2942"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="109.8" x2="109.8" y1="69.7723" y2="737.6672"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="260.7" x2="260.7" y1="69.7723" y2="737.6672"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 5.0,5.0;" x1="416.7" x2="416.7" y1="69.7723" y2="737.6672"/><rect fill="#FEFECE" filter="url(#fuqztke2objy4)" height="18.293" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="83.4" x="68.4" y="46.0793"/><rect fill="#FEFECE" filter="url(#fuqztke2objy4)" height="18.293" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="83.4" x="66" y="48.4793"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="75" x="70.2" y="60.8004">Notification-Topic</text><rect fill="#FEFECE" filter="url(#fuqztke2objy4)" height="18.293" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="83.4" x="68.4" y="737.0672"/><rect fill="#FEFECE" filter="url(#fuqztke2objy4)" height="18.293" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="83.4" x="66" y="739.4672"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="75" x="70.2" y="751.7883">Notification-Topic</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="97.2" x="210.3" y="68.0004">Central Event Processor</text><ellipse cx="260.7" cy="50.2793" fill="#FEFECE" filter="url(#fuqztke2objy4)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><polygon fill="#A80036" points="258.3,43.0793,261.9,40.0793,260.7,43.0793,261.9,46.0793,258.3,43.0793" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="97.2" x="210.3" y="745.1883">Central Event Processor</text><ellipse cx="260.7" cy="756.5602" fill="#FEFECE" filter="url(#fuqztke2objy4)" rx="7.2" ry="7.2" style="stroke: #A80036; stroke-width: 1.2000000476837158;"/><polygon fill="#A80036" points="258.3,749.3602,261.9,746.3602,260.7,749.3602,261.9,752.3602,258.3,749.3602" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="39.6" x="395.1" y="68.0004">CEP Store</text><path d="M405.9,38.2793 C405.9,32.2793 416.7,32.2793 416.7,32.2793 C416.7,32.2793 427.5,32.2793 427.5,38.2793 L427.5,53.8793 C427.5,59.8793 416.7,59.8793 416.7,59.8793 C416.7,59.8793 405.9,59.8793 405.9,53.8793 L405.9,38.2793 " fill="#FEFECE" filter="url(#fuqztke2objy4)" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><path d="M405.9,38.2793 C405.9,44.2793 416.7,44.2793 416.7,44.2793 C416.7,44.2793 427.5,44.2793 427.5,38.2793 " fill="none" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="39.6" x="395.1" y="745.1883">CEP Store</text><path d="M405.9,752.9602 C405.9,746.9602 416.7,746.9602 416.7,746.9602 C416.7,746.9602 427.5,746.9602 427.5,752.9602 L427.5,768.5602 C427.5,774.5602 416.7,774.5602 416.7,774.5602 C416.7,774.5602 405.9,774.5602 405.9,768.5602 L405.9,752.9602 " fill="#FEFECE" filter="url(#fuqztke2objy4)" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><path d="M405.9,752.9602 C405.9,758.9602 416.7,758.9602 416.7,758.9602 C416.7,758.9602 427.5,758.9602 427.5,752.9602 " fill="none" style="stroke: #000000; stroke-width: 0.9000000357627869;"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="107.1" y="145.1039"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="655.8949" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="257.7" y="75.7723"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="413.7" y="253.4356"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="413.7" y="309.0082"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="37.5727" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="413.7" y="588.5625"/><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="18" style="stroke: #A80036; stroke-width: 0.6000000238418579;" width="6" x="413.7" y="667.3078"/><path d="M7.2,79.9723 L172.2,79.9723 L172.2,84.1723 L166.2,90.1723 L7.2,90.1723 L7.2,79.9723 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="647.4949" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="449.1" x="7.2" y="79.9723"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="16.2" y="88.1133">Limit Adjustment Rules Validation</text><path d="M13.2,93.3586 L13.2,126.3586 L104.4,126.3586 L104.4,99.3586 L98.4,93.3586 L13.2,93.3586 " fill="#D3D3D3" filter="url(#fuqztke2objy4)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M98.4,93.3586 L98.4,99.3586 L104.4,99.3586 L98.4,93.3586 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="78" x="16.8" y="103.8996">Events are published</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="78.6" x="16.8" y="113.0859">to Notification Topic</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="73.8" x="16.8" y="122.2723">by Central Services.</text><polygon fill="#A80036" points="119.7,142.7039,113.7,145.1039,119.7,147.5039,117.3,145.1039" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="116.1" x2="257.1" y1="145.1039" y2="145.1039"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="123.3" y="142.2586">1</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="125.4" x="131.1" y="142.2586">Consumes notification messages</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="263.7" x2="288.9" y1="180.6902" y2="180.6902"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="288.9" x2="288.9" y1="180.6902" y2="188.4902"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="264.3" x2="288.9" y1="188.4902" y2="188.4902"/><polygon fill="#A80036" points="270.3,186.0902,264.3,188.4902,270.3,190.8902,267.9,188.4902" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="267.9" y="177.8449">2</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="117.6" x="275.7" y="177.8449">Filter according to event action</text><path d="M266.4,196.2902 L266.4,220.2902 L415.8,220.2902 L415.8,202.2902 L409.8,196.2902 L266.4,196.2902 " fill="#FFFF00" filter="url(#fuqztke2objy4)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M409.8,196.2902 L409.8,202.2902 L415.8,202.2902 L409.8,196.2902 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="90" x="270" y="206.8313">Qualifying event action:</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="136.8" x="270" y="216.0176">"limit" in data.value.content.payload</text><path d="M198.3,230.2629 L235.5,230.2629 L235.5,234.4629 L229.5,240.4629 L198.3,240.4629 L198.3,230.2629 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="493.0043" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="252" x="198.3" y="230.2629"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.2" x="207.3" y="238.4039">alt</text><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="114" x="244.5" y="237.8438">[Messages event type that qualify]</text><polygon fill="#A80036" points="406.5,251.0356,412.5,253.4356,406.5,255.8356,408.9,253.4356" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="263.7" x2="410.1" y1="253.4356" y2="253.4356"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="267.9" y="250.5902">3</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="55.8" x="275.7" y="250.5902">Update current</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22.2" x="333.9" y="250.5902">limits</text><polygon fill="#FFFFE0" filter="url(#fuqztke2objy4)" points="404.4,279.2356,428.4,279.2356,434.4,285.8356,428.4,293.0356,404.4,293.0356,398.4,285.8356,404.4,279.2356" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="21.6" x="405.6" y="289.1766">limits</text><polygon fill="#A80036" points="406.5,306.6082,412.5,309.0082,406.5,311.4082,408.9,309.0082" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="263.7" x2="410.1" y1="309.0082" y2="309.0082"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="267.9" y="306.1629">4</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="24" x="275.7" y="306.1629">Create</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="302.1" y="306.1629">events</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="55.2" x="331.5" y="306.1629">per participant</text><polygon fill="#FFFFE0" filter="url(#fuqztke2objy4)" points="403.2,334.8082,430.2,334.8082,436.2,341.4082,430.2,348.6082,403.2,348.6082,397.2,341.4082,403.2,334.8082" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="24.6" x="404.4" y="344.7492">events</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="263.7" x2="288.9" y1="364.5809" y2="364.5809"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="288.9" x2="288.9" y1="364.5809" y2="372.3809"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="264.3" x2="288.9" y1="372.3809" y2="372.3809"/><polygon fill="#A80036" points="270.3,369.9809,264.3,372.3809,270.3,374.7809,267.9,372.3809" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="267.9" y="361.7356">5</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="0" x="278.1" y="361.7356"/><path d="M266.4,380.1809 L266.4,422.7809 L427.2,422.7809 L427.2,386.1809 L421.2,380.1809 L266.4,380.1809 " fill="#D3D3D3" filter="url(#fuqztke2objy4)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M421.2,380.1809 L421.2,386.1809 L427.2,386.1809 L421.2,380.1809 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="108.6" x="270" y="390.7219">Check if there is a difference</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="123.6" x="270" y="399.9082">between the stored and captured</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22.2" x="396" y="399.9082">limits</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="30.6" x="270" y="409.0945">for both</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24.6" x="303" y="409.0945">payee</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="13.8" x="330" y="409.0945">and</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23.4" x="346.2" y="409.0945">payer</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="22.2" x="270" y="418.2809">for all</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42.6" x="294.6" y="418.2809">currencies</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="337.2" y="418.2809">.</text><path d="M204.3,432.5262 L241.5,432.5262 L241.5,436.7262 L235.5,442.7262 L204.3,442.7262 L204.3,432.5262 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><rect fill="none" height="277.568" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="240" x="204.3" y="432.5262"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.2" x="213.3" y="440.6672">alt</text><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="250.5" y="440.107">[Limit difference identified]</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="263.7" x2="288.9" y1="455.6988" y2="455.6988"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="288.9" x2="288.9" y1="455.6988" y2="463.4988"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="264.3" x2="288.9" y1="463.4988" y2="463.4988"/><polygon fill="#A80036" points="270.3,461.0988,264.3,463.4988,270.3,465.8988,267.9,463.4988" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="267.9" y="452.8535">6</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="41.4" x="275.7" y="452.8535">Create new</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54.6" x="319.5" y="452.8535">Action Object</text><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="33.559" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="123" x="208.5" y="468.2988"/><polygon fill="#EEEEEE" points="208.5,468.2988,246.9,468.2988,246.9,472.4988,240.9,478.4988,208.5,478.4988,208.5,468.2988" style="stroke: #000000; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="11.4" x="216.3" y="477.0399">ref</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="96.6" x="212.1" y="488.4399">Notification Action Flow {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/central-event-processor/blob/master/docs/sequenceDiagrams/seq-cep-10.4-action-flow.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/central-event-processor/blob/master/docs/sequenceDiagrams/seq-cep-10.4-action-flow.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="16.8" x="308.7" y="488.4399">10.4</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="308.7" x2="325.5" y1="489.6399" y2="489.6399"/></a><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="325.5" y="488.4399">}</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="0" x="214.5" y="497.6262"/><line style="stroke: #000000; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="204.3" x2="444.3" y1="505.4578" y2="505.4578"/><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105.6" x="207.3" y="511.8387">[Limits are equal - same event]</text><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="263.7" x2="288.9" y1="526.6172" y2="526.6172"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="288.9" x2="288.9" y1="526.6172" y2="534.4172"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="264.3" x2="288.9" y1="534.4172" y2="534.4172"/><polygon fill="#A80036" points="270.3,532.0172,264.3,534.4172,270.3,536.8172,267.9,534.4172" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="267.9" y="523.7719">7</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="133.8" x="275.7" y="523.7719">Send Action Object to Action Agent</text><rect fill="#FFFFFF" filter="url(#fuqztke2objy4)" height="33.559" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="123" x="208.5" y="539.2172"/><polygon fill="#EEEEEE" points="208.5,539.2172,246.9,539.2172,246.9,543.4172,240.9,549.4172,208.5,549.4172,208.5,539.2172" style="stroke: #000000; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="11.4" x="216.3" y="547.9582">ref</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="96.6" x="212.1" y="559.3582">Notification Action Flow {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/central-event-processor/blob/master/docs/sequenceDiagrams/seq-cep-10.4-action-flow.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/central-event-processor/blob/master/docs/sequenceDiagrams/seq-cep-10.4-action-flow.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="16.8" x="308.7" y="559.3582">10.4</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="308.7" x2="325.5" y1="560.5582" y2="560.5582"/></a><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="2.4" x="325.5" y="559.3582">}</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="0" x="214.5" y="568.5446"/><polygon fill="#A80036" points="406.5,586.1625,412.5,588.5625,406.5,590.9625,408.9,588.5625" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="263.7" x2="410.1" y1="588.5625" y2="588.5625"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="267.9" y="585.7172">8</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="30" x="275.7" y="585.7172">Request</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54.6" x="308.1" y="585.7172">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="33.6" x="365.1" y="585.7172">for event</text><polygon fill="#FFFFE0" filter="url(#fuqztke2objy4)" points="401.4,596.3625,431.4,596.3625,437.4,602.9625,431.4,610.1625,401.4,610.1625,395.4,602.9625,401.4,596.3625" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="27.6" x="402.6" y="606.3035">actions</text><polygon fill="#A80036" points="270.3,623.7352,264.3,626.1352,270.3,628.5352,267.9,626.1352" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="266.7" x2="416.1" y1="626.1352" y2="626.1352"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5.4" x="273.9" y="623.2899">9</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="52.8" x="281.7" y="623.2899">Return results</text><path d="M266.4,633.9352 L266.4,648.9352 L426.6,648.9352 L426.6,639.9352 L420.6,633.9352 L266.4,633.9352 " fill="#D3D3D3" filter="url(#fuqztke2objy4)" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><path d="M420.6,633.9352 L420.6,639.9352 L426.6,639.9352 L420.6,633.9352 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="65.4" x="270" y="644.4762">Deactive pending</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54.6" x="337.8" y="644.4762">Action Object</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="22.8" x="394.8" y="644.4762">event.</text><polygon fill="#A80036" points="406.5,664.9078,412.5,667.3078,406.5,669.7078,408.9,667.3078" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.6000000238418579;" x1="263.7" x2="410.1" y1="667.3078" y2="667.3078"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="267.9" y="664.4625">10</text><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="58.2" x="281.1" y="664.4625">Persist updated</text><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54.6" x="341.7" y="664.4625">Action Object</text><polygon fill="#FFFFE0" filter="url(#fuqztke2objy4)" points="401.4,693.1078,431.4,693.1078,437.4,699.7078,431.4,706.9078,401.4,706.9078,395.4,699.7078,401.4,693.1078" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="27.6" x="402.6" y="703.0489">actions</text><line style="stroke: #000000; stroke-width: 0.6000000238418579; stroke-dasharray: 2.0,2.0;" x1="198.3" x2="450.3" y1="714.8942" y2="714.8942"/><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="197.4" x="201.3" y="721.275">[Ignore - Message does not qualify for notification action]</text><!--
@startuml
title 10.2. Notification Limit Adjustment Rules Validation
autonumber

collections "Notification-Topic" as topicNotify
control "Central Event Processor" as CEP
database "CEP Store" as DB

box "Central Services" #LightYellow
participant topicNotify
end box
box "Central Event Processing Service" #LightGreen
participant CEP
participant DB
end box

Group Limit Adjustment Rules Validation
    activate CEP
    note left of topicNotify #LightGrey
        Events are published
        to Notification Topic
        by Central Services.
    end note
    topicNotify <- CEP: Consumes notification messages
    activate topicNotify
    deactivate topicNotify
    CEP -> CEP: Filter according to event action
    note right of CEP #yellow
        Qualifying event action:
        "limit" in data.value.content.payload
    end note

    alt Messages event type that qualify
        CEP -> DB: Update current **limits**
        activate DB
        hnote over DB #LightYellow
            limits
        end hnote
        deactivate DB
        CEP -> DB: Create **events** per participant
        activate DB
        hnote over DB #LightYellow
            events
        end hnote
        deactivate DB
        CEP -> CEP
        note right of CEP #LightGrey
            Check if there is a difference
            between the stored and captured **limits**
            for both **payee** and **payer**
            for all **currencies**.
        end note

        alt Limit difference identified
            CEP -> CEP: Create new **Action Object**
            ref over CEP :  Notification Action Flow {[[https://github.com/mojaloop/central-event-processor/blob/master/docs/sequenceDiagrams/seq-cep-10.4-action-flow.svg 10.4]]} \n
        else Limits are equal - same event
            CEP -> CEP: Send Action Object to Action Agent
            ref over CEP :  Notification Action Flow {[[https://github.com/mojaloop/central-event-processor/blob/master/docs/sequenceDiagrams/seq-cep-10.4-action-flow.svg 10.4]]} \n
            CEP -> DB: Request **Action Object** for event
            activate DB
            hnote over DB #LightYellow
                actions
            end hnote
            CEP <- - DB: Return results
            deactivate DB
            note right of CEP #lightGrey
                Deactive pending **Action Object** event.
            end note
            CEP -> DB: Persist updated **Action Object**
            activate DB
            hnote over DB #LightYellow
                actions
            end hnote
           deactivate DB
        end
    else Ignore - Message does not qualify for notification action
    end
end
    deactivate CEP
@enduml

PlantUML version 1.2018.11(Sat Sep 22 18:43:53 SAST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1343-b26
Operating System: Mac OS X
OS Version: 10.14.2
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>